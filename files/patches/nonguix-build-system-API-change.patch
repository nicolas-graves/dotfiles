From 08738f1acad1f6029f70457d7d169e6fdb0c8979 Mon Sep 17 00:00:00 2001
Message-ID: <08738f1acad1f6029f70457d7d169e6fdb0c8979.1748532745.git.ngraves@ngraves.fr>
From: Nicolas Graves <ngraves@ngraves.fr>
Date: Thu, 24 Apr 2025 23:26:08 +0200
Subject: [PATCH] Update to the new Guix API.

---
 nonguix/build-system/binary.scm          | 8 ++++----
 nonguix/build-system/chromium-binary.scm | 8 ++++----
 2 files changed, 8 insertions(+), 8 deletions(-)

diff --git a/nonguix/build-system/binary.scm b/nonguix/build-system/binary.scm
index 2eb1c30..6583a15 100644
--- a/nonguix/build-system/binary.scm
+++ b/nonguix/build-system/binary.scm
@@ -84,7 +84,7 @@
 
 (define* (binary-build name inputs
                        #:key
-		       guile source
+		       guile modules source
                        (outputs '("out"))
                        (patchelf-plan ''())
                        (install-plan ''(("." "./")))
@@ -100,9 +100,6 @@
                                    %standard-phases))
                        (system (%current-system))
                        (imported-modules %binary-build-system-modules)
-                       (modules '((nonguix build binary-build-system)
-                                  (guix build utils)
-                                  (nonguix build utils)))
                        (substitutable? #t)
                        allowed-references
                        disallowed-references)
@@ -144,6 +141,9 @@ provides its own binaries."
   (build-system
     (name 'binary)
     (description "The standard binary build system")
+    (modules '((nonguix build binary-build-system)
+               (guix build utils)
+               (nonguix build utils)))
     (lower lower)))
 
 ;;; binary.scm ends here
diff --git a/nonguix/build-system/chromium-binary.scm b/nonguix/build-system/chromium-binary.scm
index 4a5baaf..fbc020f 100644
--- a/nonguix/build-system/chromium-binary.scm
+++ b/nonguix/build-system/chromium-binary.scm
@@ -146,7 +146,7 @@
 
 (define* (chromium-binary-build name inputs
                        #:key
-		       guile source wrap-inputs
+		       guile modules source wrap-inputs
                        (outputs '("out"))
                        (wrapper-plan ''())
                        (patchelf-plan ''())
@@ -163,9 +163,6 @@
                                    %standard-phases))
                        (system (%current-system))
                        (imported-modules %chromium-binary-build-system-modules)
-                       (modules '((nonguix build chromium-binary-build-system)
-                                  (guix build utils)
-                                  (nonguix build utils)))
                        (substitutable? #t)
                        allowed-references
                        disallowed-references)
@@ -216,6 +213,9 @@ ignored if WRAPPER-PLAN is not '()."
   (build-system
     (name 'chromium-binary)
     (description "The Chromium based binary build system")
+    (modules '((nonguix build chromium-binary-build-system)
+               (guix build utils)
+               (nonguix build utils)))
     (lower lower)))
 
 ;;; chromium-binary.scm ends here
-- 
2.49.0

